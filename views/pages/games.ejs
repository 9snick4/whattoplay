<!DOCTYPE html>
<html>
<head>
  <% include ../partials/header.ejs %>
  <script src="../../public/javascript/xml2json.js"></script>
  <script>
    function getQueryVariable(variable)
    {
          var query = window.location.search.substring(1);
          var vars = query.split("&");
          for (var i=0;i<vars.length;i++) {
                  var pair = vars[i].split("=");
                  if(pair[0] == variable){return pair[1];}
          }
          return(false);
    }

    function getRetry(username, tries) {
      $.get("https://www.boardgamegeek.com/xmlapi2/collection=1&username=" +username)
        .fail(function() {
          if (tries < 10)
            return setTimeout(getRetry,7000,username, tries + 1);
          else
            $("#errorMessage").text("Could not retrieve collection.");
            return;
        })
        .done(function(data) {
          $("#errorMessage").text(data);
        })
    }
    var night = getQueryVariable("night");
    getRetry(night.hostusername,1);
  </script>
</head>

<body>

<% include ../partials/nav.ejs %>

<div class="container">
<h2>Games</h2>
<ul>
    
</ul> 

</div>
<div id="errorMessage">
</div>
</body>
</html>
